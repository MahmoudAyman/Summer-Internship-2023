<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

  <!-- CHANGE YOUR NAME -->
  <title>Hady Hisham || Summer Internship</title>

  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
  <link rel="shortcut icon" href="images/favicon.ico"  type="image/x-icon">
  <link href='http://fonts.googleapis.com/css?family=Droid+Serif|Ubuntu' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" href="css/normalize.css">
  <link rel="stylesheet" href="js/flexslider/flexslider.css">
  <link rel="stylesheet" href="css/colorblocks-style.css">
  <script src="js/libs/modernizr-2.6.2.min.js"></script>
</head>


<body id="home">
    <header class="wrapper clearfix">
		       
        <div id="banner">        
        	<div id="logo"><a href=""><img src="images/logo.png" alt="logo" height="30%" width="30%"></a></div> 
        </div>

        <nav id="topnav" role="navigation">
          <div class="menu-toggle">Menu</div>  
            <ul class="srt-menu" id="menu-main-navigation" style="padding-bottom: 10px;">
              <li class="current"><a href="index.html">Home</a></li>
              <li>
                <a href="assignment_1.html">Projects</a>
                <ul>
                  <li><a href="assignment_1.html">AVR Programmer</a></li>
                  <li><a href="assignment_2.html">Communication Protocols Project</a></li>
                  <!--<li><a href="assignment_1.html">Assignment</a></li>
                  <li><a href="assignment_1.html">Assignment</a></li>
                  <li><a href="assignment_1.html">Assignment</a></li>-->
                </ul>
              </li>
              <li><a href="final.html">Final Project</a></li>
            </ul>     
        </nav>
  
    </header><!-- end header -->
 
    <section id="page-header" class="clearfix">    
   
    <div class="wrapper">
      <h1>Communication Protocols Project</h1>
    </div>
    </section>

<div id="main" class="wrapper clearfix">    
    
	<section id="content">
    <!-- ADD YOUR THE STEPS OF YOUR DOCUMENTATION BELOW -->
    <!-- TO ADD IMAGES YOU WILL FIND IMG TAGS BETWEEN PARAGRAPHS -->
    <!-- ADD THE NAME OF YOUR FILE -->
				<h1>stm32F303RE Configuration Steps:</h1>
				<h2>Configuration of RCC (Clock Control Register):</h2>
				<p><br>To start programming on the stm32F303RE microcontroller and with any ST microcontroller, everything needed must be enabled first through the RCC reg. <br>
					this can be done by derefrencing the RCC using (->) and choosing the needed peripherals or buses and this can be achieved by using the archeticture of the controller.<br>
					for example, if we want to enable Port A of the general purpose input and outputs(GPIOs), the chosen bus is AHBENR (AHB Peripheral clock enable register) and the code can be written like this:<br>
					<br>RCC->AHBENR |= (1&lt &lt (the bit needed)) </p>
	            <h2>Configuration of GPIOs:</h2>
				<p><br>First, configuration of the pin modes. this includes four modes and can be choosen throught the bit value in the port mode register (GPIOx_MODER). Each pin on the port has 2 bits in the GPIOx_MODER.<br>
					these four modes are:<br><br> 
					- Input mode  (reset state) at bit value 00<br>
					- General purpose output mode at bit value 01<br>
					- Alternate function mode at bit value 10<br>
					- Analog at bit value 11<br><br>
					</p>
					<img src="images/GPIO_MODER.PNG">
					<p>After this according to your preference if the pin is configured as an output pin , we will use the port output type register(GPIOx_OTYPER). This register will determine whether the pin
					uses: <br><br>
					- Output Push/Pull at bit value 0<br>
					- Output open-drain at bit value 1<br><br>
					</p>
					<img src="images/GPIO_OTYPER.PNG">
					<p>Then we have to specify the speed of this output pin. To do that we will use the GPIO output speed register(GPIOx_OSPEEDR). It can be configured by:<br><br>
					- Low speed at bit value x0 where x is 0 or 1 doesn't matter.<br>
					- Medium speed at bit value 01<br>
					- High speed at bit value 11<br><br>
					</p>
					<img src="images/GPIO_OSPEEDR.PNG">
					<p>At the end we will specify if the pin is pull up or down assuming it's configured to do so from the port output type register:<br><br>
					- No pull up,pull down at bit value 00<br>
					- pull up at bit value 01<br>
					- pull down at bit value 10</p>
					<img src="images/GPIO_PUPDR.PNG">
					<h2>UART Initialization:</h2>
					<p>UART initialization starts with knowing which UART peripheral in the stm32 chip is going to be used.<br>
					First, the ABPENR1 or ABPENR2 as deictated by the selected UART but each bus has runs on a different clock frequency where ABPENR1 runs on 72MHz and ABPENR2 runs on 32MHz.<br><br>
					then, it's time to enable the UART in the ABPENR register. In this project USART2 is used which is found on ABPENR2 bus and so it's bit in the ABPENR2 is set to high with the same method used to enable the GPIO ports.<br><br>
					After that, we enable the GPIO port that contains the Tx and Rx pins of the UART. These pins are PA2 and PA3 respectively.<br><br>
					lastly, PA2 and PA3 are configured as alternate function pins by putting the value 1,0 in the corresponding pins in the MODER register, then 0 in the OTYPER register and as high speed in the OSPEEDR register.<br><br>
					Now, the alternate function of the pins should be selected. This is done by configuring the AFR (Alternate Function Register).
					this register is divided into two register AFRL (low) and AFRH(high).
					each pin is has 16 alternate function that is multiplexed into 4 bits. 
					Since we are using PA2 and PA3, we will configure them in the AFRL register. To select them as Tx and Rx, the AFRL is set to AF7 value which is 0111 in binary in bits 8,9,10,11 and 12,13,14,15.<br><br></p>
					<img src="images/AFRL.PNG">
					<h2>Baudrate Selection:</h2>
					<p>The UART protocol is asynchronous and doesn't use a clock to receive and send the data so it relays on the baudrate. to select the baudrate we first need to know about the oversampling concept.<br>
					<br><br>The receiver must sample the incoming data stream at a rate that is higher than the bit rate to determine when each bit starts and ends 1. Oversampling is used to increase the sampling rate and improve the accuracy of the sampling process.Usually, the oversampling is set to be 16 using the OVER8 and setting it to 0 in the UART Control Register 1(USART_CR1).<br>
					to select the baudrate we desire ,9600 in this project, we divide the Fck value of the ABPENR selected bus which is the ABPENR2 on the baudrate desired (9600) and then putting the result as a value of hexadecimal in the USART_BRR register(Baud Rate Register).In this project the value is 0xEA6.<br><br></p>
					<img src="images/Baudrate_generation.PNG">
					<img src="images/BRR.PNG">
					<p>Now, we can enable the pins to send or receive data by setting the bits UE(UART Enable), TE (Transmit Enable),RE(Receive Enable)in the USART_CR1 and then, we can start using the UART just without interrupts yet.<br><br></p>
					<img src="images/UART_CR1.PNG">
					<p>Notice: The BRR value should be set before setting the UART Enable bit (UE) in the USART_CR1.</p>
                <h1>Block Diagram:</h1>
                
                <img src="images/communication.PNG">
                               
                <h1>Circuit Design:</h1>
				<p>to be updated</p>
                <img src="">

                <h1>PCB Layout:</h1>
                <p>to be updated</p>
                <img src="">
                
                <h1>Manufacturing:</h1>
                <p>to be updated</p>
                <img src="">
                
                <h1>Firmware:</h1>
                <p>to be updated</p>
                <img src="">
                  
				<h1>Testing:</h1>
                <p>to be updated</p>
                <img src="">

</section><!-- #end content area -->
      
      
    <!-- sidebar -->    
    <aside>
        <h2>See also: </h2>
            <nav id="secondary-navigation">
                    <ul>
                        <li><a href="assignment_1.html">AVR Programmer</a></li>
                        <li class="current"><a href="assignment_2.html">Communication Protocols Project</a></li>
						<!--<li><a href="assignment_1.html">p</a></li>
                        <li><a href="assignment_1.html">Assignment</a></li>
                        <li><a href="assignment_1.html">Assignment</a></li>
                        <li><a href="assignment_1.html">Assignment</a></li>-->

                    </ul>
             </nav>
      </aside><!-- #end sidebar -->
    
    
    
</div><!-- #end div #main .wrapper -->





<!-- footer area -->    
<footer>
        <div id="colophon" class="wrapper clearfix">
          <h2 style="padding-left: 30px;">PROUDLY MADE BY MAKERS</h2>
            <img src="images/logo.png" height="30%" width="30%">
        </div>
        
    </footer><!-- #end footer area --> 


<!-- jQuery -->
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="js/libs/jquery-1.9.0.min.js">\x3C/script>')</script>

<script defer src="js/flexslider/jquery.flexslider-min.js"></script>

<!-- fire ups - read this file!  -->   
<script src="js/main.js"></script>

</body>
</html>